---
layout: post
published: true
title: Working around the Template Explorer Issue in MCMS 2002 and VS2005
tags: Software Development, .NET, content management, Visual Studio, MCMS    
permalink: /2006-06-29-working-around-the-template-explorer-issue-in-mcms-2002-and-vs2005.html
description: After a somewhat extended break, I've again found myself developing for Microsoft's Content Management Server. Aside from some minor features and fixes added b
summary: After a somewhat extended break, I've again found myself developing for Microsoft's Content Management Server. Aside from some minor features and fixes added by new service packs, not that much has changed in MCMS 2002&ndash;with the exception of .NET 2.0 support added in SP2.<br />
---
<div>After a somewhat extended break, I've again found myself developing for Microsoft's Content Management Server. Aside from some minor features and fixes added by new service packs, not that much has changed in MCMS 2002&ndash;with the exception of .NET 2.0 support added in SP2.<br /><a name='more'></a><br />If you've spent any amount of time trying to get your development environment to support this MCMS on .NET 2.0, you've probably pulled out some hair trying to make the MCMS developer tools - most notably the Template Explorer - consistently appear in VS2005. In a single-project (i.e. an MCMS web project only) solution, this is fairly straight-forward. But the minute you add another, non-web project to the solution, the Template Explorer disappears and cannot be re-opened, effectively rendering MCMS useless.<br /><br />Apparently Microsoft had a hotfix for this issue, but have since stopped distributing it. This means that to develop an MCMS website with any semblance of a n-tier application, you're going to have to jump through some hoops until a new hotfix is released. Here's the steps that I've taken to get my team up and running with MCMS 2002 SP2, .NET 2.0, and VS2005:<br /><br />1) Configure each workstation as documented in the SP2 installation readme (available online <a href="http://support.microsoft.com/default.aspx?id=906145">here</a>). For a more concise and accurate version of this document, check out the <a href="http://www.mcmsfaq.com/articles/sp2install.asp">Rational Guide to installing MCMS 2002 Service Pack 2</a> at <a href="http://www.mcmsfaq.com/">mcmsfaq.com</a> (which incidentally, is an excellent MCMS resource).<br /><br />2) Use the Web Application Project type as the primary web project. If you don't have Web Application Project installed (and why not!?), you can download it <a href="http://msdn.microsoft.com/asp.net/reference/infrastructure/wap/default.aspx">here</a>. There is also <a href="/admin/blogs/Using%20the%20Visual%20Studio%202005%20Web%20Application%20Project%20with%20MCMS%20SP2">another great article</a> at <a href="http://www.mcmsfaq.com/">mcmsfaq.com</a> that explains how to make a Web Application Project as a MCMS 2002-compatible. The only downside to using the Web Application Project type is that the MCMS web form template won't show up in the VS <span style="font-family: Courier New;">Add New Item</span> dialog. You can, however, repurpose the template provided in SP2 for Visual Web Developer projects:<br /><br />Copy the MCMSWebItem template archives (these are the files you copied in the final steps of #1 above) from the Visual Web Developer template folder (e.g. <span style="font-family: Courier New;">c:\my documents\Visual Studio 2005\Templates\ItemTemplates\Visual Web Developer\CSHARP\1033</span> for the C# templates) to the corresponding language item template folder. For example, if I was copying the C# template, it would go to <span style="font-family: Courier New;">c:\My Documents\Visual Studio 2005\Templates\ItemTemplates\Visual C#\1033\</span>.<br /><br />Open the template archive and edit the .vstemplate file. Remove the following line: <span style="font-family: Courier New;">&lt;ProjectSubType&gt;#languageName#&lt;/ProjectSubType&gt;</span> (where #languageName# is the name of the language this template is for). Change the value in <span style="font-family: Courier New;">&lt;ProjectType&gt;&lt;/ProjectType&gt;</span> from <span style="font-family: Courier New;">Web</span> to the name of the language you're using (e.g. <span style="font-family: Courier New;">CSHARP</span>, <span style="font-family: Courier New;">VB</span>, etc.) Save, overwriting the existing file in the archive.<br /><br />At the Visual Studio command-line, run <span style="font-family: Courier New;">devenv /setup</span>.<br /><br />Voila! The <span style="font-family: Courier New;">MCMS Template Item</span> file type should now show up under <span style="font-family: Courier New;">My Templates</span> in the <span style="font-family: Courier New;">Add New Item</span> dialog.<br /><br />3) Segment the solution using two solution files. Yes, I realize that this is a real pain in the ass, but its the only way to layer your application and still have access to the Template Explorer window. For my projects, I create a primary solution (e.g. <span style="font-family: Courier New;">MyProject.sln</span>) that contains all (including the two web projects you'll have at this point - see step #2 above) projects. The main purpose of this project is to develop class libraries, data access layers, custom control libraries, etc., and to do local builds (in other words, I don't touch the web projects here). I then create a second solution that contains only the two web projects (e.g. <span style="font-family: Courier New;">MyProject.Web.sln</span>) thereby providing relatively stable access to the Template Explorer.<br /><br />klc;</div>